<!-- //src/app/calls/calss.html-->
<h2>Llamadas</h2>

<!-- Filtros -->
<div class="filters">
  <button (click)="changePeriod('today')" [class.active]="currentPeriod === 'today'" class="filter-btn">Hoy</button>
  <button (click)="changePeriod('week')" [class.active]="currentPeriod === 'week'" class="filter-btn">Últimos 7 días</button>
  <button (click)="changePeriod('month')" [class.active]="currentPeriod === 'month'" class="filter-btn">Últimos 30 días</button>
  <button (click)="changePeriod('year')" [class.active]="currentPeriod === 'year'" class="filter-btn">Último año</button>
</div>

<!-- Resumen -->
<p>{{ totalCalls }} llamadas encontradas.</p>

<!-- Tabla -->
@if (calls.length > 0) {
  <table class="calls-table">
    <thead>
      <tr>
        <th>De</th>
        <th>Para</th>
        <th>Duración</th>
        <th>Fecha</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>
      @for (call of calls; track call.calldate) {
        <tr>
          <td>{{ call.src }}</td>
          <td>{{ call.dst }}</td>
          <td>{{ call.duration }} seg</td>
          <td>{{ call.calldate | date:'HH:mm - dd/MM/yyyy' }}</td>
          <td [class.call-status]="true" [class.answered]="call.disposition === 'ANSWERED'">
            {{ call.disposition === 'ANSWERED' ? 'Contestada' : 'No contestada' }}
          </td>
        </tr>
      }
    </tbody>
  </table>
} @else if (!loading) {
  <p>No hay llamadas en este período.</p>
}

<!-- Paginación -->
@if (totalPages > 1) {
  <div class="pagination">
    <button (click)="loadCalls(1)" [disabled]="currentPage === 1">Primera</button>
    <button (click)="loadCalls(currentPage - 1)" [disabled]="currentPage === 1">Anterior</button>
    
    <span>{{ currentPage }} / {{ totalPages }}</span>
    
    <button (click)="loadCalls(currentPage + 1)" [disabled]="currentPage === totalPages">Siguiente</button>
    <button (click)="loadCalls(totalPages)" [disabled]="currentPage === totalPages">Última</button>
  </div>
}